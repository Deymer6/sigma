<div class="upload-card">
  <div class="card-header">
    <h3><i class="bi bi-cloud-upload-fill"></i> Subir Resultado</h3>
    <p>Adjunta ecografías, análisis de sangre o informes.</p>
  </div>

  <form [formGroup]="uploadForm" (ngSubmit)="onSubmit()">
    
    <div class="form-group">
      <label>Tipo de Análisis</label>
      <select formControlName="tipoAnalisis" class="form-control">
        <option value="" disabled selected>Seleccionar tipo...</option>
        <option value="Ecografía">Ecografía</option>
        <option value="Hemograma">Hemograma</option>
        <option value="Orina">Análisis de Orina</option>
        <option value="Otro">Otro</option>
      </select>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Fecha Realización</label>
        <input type="date" formControlName="fecha" class="form-control">
      </div>
      
      <div class="form-group file-group">
        <label>Archivo (PDF/Imagen)</label>
        <input type="file" (change)="onFileSelected($event)" accept=".pdf,.jpg,.png" class="form-control-file">
      </div>
    </div>

    <div class="form-group">
      <label>Observaciones / Resultados</label>
      <textarea formControlName="observaciones" rows="3" class="form-control" placeholder="Ej: Niveles normales, feto en posición..."></textarea>
    </div>

    @if (message()) {
      <div class="alert" [class.success]="message()?.type === 'success'" [class.error]="message()?.type === 'error'">
        {{ message()?.text }}
      </div>
    }

    <button type="submit" class="btn-upload" [disabled]="uploadForm.invalid || !selectedFile || isUploading()">
      @if (isUploading()) {
        <span class="spinner"></span> Subiendo...
      } @else {
        <i class="bi bi-send-fill"></i> Guardar Análisis
      }
    </button>

  </form>
</div>